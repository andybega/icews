<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get ICEWS Event Data • icews</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Get ICEWS Event Data">
<meta property="og:description" content="Download utilities and other helpers for getting
    the ICEWS event data from Dataverse.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">icews</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/icews.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/icews-event-data.html">ICEWS event data</a>
    </li>
    <li>
      <a href="articles/speed-comparison-database-versus-file-based.html">Speed comparison database versus file-based</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andybega/icews">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="icews" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#icews" class="anchor"></a>icews</h1></div>

<p>Get the ICEWS event data from the Dataverse repos at <a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/28075">https://doi.org/10.7910/DVN/28075</a> (historic data) and <a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/QI2T9A">https://doi.org/10.7910/DVN/QI2T9A</a> (daily updates from late 2018 on).</p>
<p>The icews package provides these major features:</p>
<ul>
<li>get the ICEWS event data without having to deal with Dataverse</li>
<li>use raw data files (tab-separated variables, .tsv) or a database (SQLite3) or both as the storage backend</li>
<li>set options so that in future R sessions icews knows where your data lives</li>
<li>icews keeps the local data in sync with the latest versions on Dataverse</li>
</ul>
<p><em>Note about stability:</em></p>
<p><em>This package is young. The core functionality of the package involves downloading and keeping track of potentially 10+GB of files and data. I have not found a good way to test that thoroughly. There are probably bugs and errors that pop up on a fresh run without any downloaded data already in place. Please file bug reports or email me (<a href="mailto:adbeger@gmail.com">adbeger@gmail.com</a>)!</em></p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Not on CRAN, so you will have to install via remotes or devtools:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"remotes"</span>)
remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"andybega/icews"</span>)</code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p><strong>tl;dr</strong>: get a SQLite database with the current events on DVN with this code; otherwise read below for more details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"icews"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"DBI"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"dplyr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"usethis"</span>)

<span class="kw"><a href="reference/setup_icews.html">setup_icews</a></span>(<span class="dt">data_dir =</span> <span class="st">"/where/should/data/be"</span>, <span class="dt">use_db =</span> <span class="ot">TRUE</span>, <span class="dt">keep_files =</span> <span class="ot">TRUE</span>,
            <span class="dt">r_profile =</span> <span class="ot">TRUE</span>)
<span class="co"># this will give instructions for what to add to .Rprofile so that settings</span>
<span class="co"># persist between R sessions</span>

<span class="kw"><a href="reference/update_icews.html">update_icews</a></span>(<span class="dt">dryrun =</span> <span class="ot">TRUE</span>)
<span class="co"># Should list proposed downloads, ingests, etc.</span>
<span class="kw"><a href="reference/update_icews.html">update_icews</a></span>(<span class="dt">dryrun =</span> <span class="ot">FALSE</span>)
<span class="co"># Wait until all is done; like 45 minutes or more the first time around</span>

<span class="co"># To get the data:</span>
con &lt;-<span class="st"> </span><span class="kw"><a href="reference/connect.html">connect</a></span>()
DBI<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DBI/topics/dbGetQuery">dbGetQuery</a></span>(con, <span class="st">"SELECT count(*) AS n FROM events;"</span>)
<span class="co"># or</span>
<span class="kw"><a href="reference/query_icews.html">query_icews</a></span>(<span class="st">"SELECT count(*) AS n FROM events;"</span>)
<span class="co"># or</span>
con &lt;-<span class="st"> </span><span class="kw"><a href="reference/connect.html">connect</a></span>()
dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span>(con, <span class="st">"events"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">n =</span> <span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>())
<span class="co"># or, </span>
<span class="co"># read all 17+ million rows into memory</span>
events &lt;-<span class="st"> </span><span class="kw"><a href="reference/read_icews.html">read_icews</a></span>()</code></pre></div>
<div id="files-only" class="section level3">
<h3 class="hasAnchor">
<a href="#files-only" class="anchor"></a>Files only</h3>
<p>In the most simple use case, you can use the package to download the ICEWS event data, which comes in several tab-serparated value (TSV) files, without having to deal with Dataverse.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/files2">dir.create</a></span>(<span class="st">"~/Downloads/icews"</span>)
<span class="kw"><a href="reference/download_data.html">download_data</a></span>(<span class="st">"~/Downloads/icews"</span>)</code></pre></div>
<p>This will conventiently also re-use and update any files already in the same directory. Zipped files will be unzipped. E.g. the monthly data updates currently come in a file with the pattern “events.2018.yyyymmddhhmmss.tab”, where the “yyyymmddhhmmss” part changes. The downloader can identify this and will replace the old with the new file.</p>
<p>Just in case, you can do a dry run that will not actually make any changes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/download_data.html">download_data</a></span>(<span class="st">"~/Downloads/icews"</span>, <span class="dt">dryrun =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">Found</span> 25 local data file(s)
<span class="ex">Downloading</span> 2 new file(s)
<span class="ex">Removing</span> 1 old local file(s)

<span class="ex">Plan</span>:
<span class="ex">Download</span> <span class="st">'events.1995.20150313082510.tab.zip'</span>
<span class="ex">Download</span> <span class="st">'events.1996.20150313082528.tab.zip'</span>
<span class="ex">Remove</span>   <span class="st">'events.1996.20140313082528.tab'</span></code></pre></div>
<p>The events come in (zipped) tab-seperated files. To load all of these into memory in a big combined data frame with about 16 million rows (~2.5Gb):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">events &lt;-<span class="st"> </span><span class="kw"><a href="reference/read_icews.html">read_icews</a></span>(<span class="st">"~/Downloads/icews"</span>)</code></pre></div>
<p>Beyond this basic usage, the goal is to abstract as many little pains away as possible. To that end:</p>
</div>
<div id="persist-the-data-directory-location" class="section level3">
<h3 class="hasAnchor">
<a href="#persist-the-data-directory-location" class="anchor"></a>Persist the data directory location</h3>
<p>The package can keep track of the data location via variables stored in the package options. The easiest way is to add these to an “.Rprofile” file so that they are available each time R starts up.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/setup_icews.html">setup_icews</a></span>(<span class="dt">data_dir =</span> <span class="st">"/where/should/data/be"</span>, <span class="dt">use_db =</span> <span class="ot">TRUE</span>, 
            <span class="dt">keep_files =</span> <span class="ot">TRUE</span>, <span class="dt">r_profile =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>This will open the “.Rprofile” file and tell you what to add to it (requires <a href="https://cran.r-project.org/package=usethis">usethis</a> to be installed). From now on the package knows where your data lives, and most of the functions can be called without specifying any directory or path arguments.</p>
<p>This sets three variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ICEWS data location and options</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">icews.data_dir   =</span> <span class="st">"~/path/to/icews_data"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">icews.use_db     =</span> <span class="ot">TRUE</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">icews.keep_files =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="use-a-sqlite-database-that-keeps-in-sync-with-dvn" class="section level3">
<h3 class="hasAnchor">
<a href="#use-a-sqlite-database-that-keeps-in-sync-with-dvn" class="anchor"></a>Use a SQLite database that keeps in sync with DVN</h3>
<p>To setup and populate a database with the current version on DVN, use this command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># assumes setup_icews with use_db = TRUE has already been called</span>
<span class="kw"><a href="reference/update_icews.html">update_icews</a></span>(<span class="dt">dryrun =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>This will download any data files needed from DVN, and create and populate a SQLite database with them. The events will be in a table called “events”. To connect, use <code><a href="reference/connect.html">connect()</a></code>; this returns a RSQLite database connection. From then on, it can be used like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"DBI"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"dplyr"</span>)

con &lt;-<span class="st"> </span><span class="kw"><a href="reference/connect.html">connect</a></span>()

<span class="kw"><a href="https://www.rdocumentation.org/packages/DBI/topics/dbGetQuery">dbGetQuery</a></span>(con, <span class="st">"SELECT count(*) FROM events;"</span>)
<span class="co"># or</span>
<span class="kw"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span>(con, <span class="st">"events"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">n =</span> <span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>())</code></pre></div>
<p>When done, it is good etiquette to close to the database connection:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DBI<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DBI/topics/dbDisconnect">dbDisconnect</a></span>(con)</code></pre></div>
</div>
<div id="bonus-cameo-codes" class="section level3">
<h3 class="hasAnchor">
<a href="#bonus-cameo-codes" class="anchor"></a>Bonus: CAMEO codes</h3>
<p>Also included is a dictionary of the CAMEO code for event types. This includes quad and penta category mappings as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"cameo_codes"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(cameo_codes)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    312 obs. of  11 variables:</span>
<span class="co">#&gt;  $ cameo_code    : chr  "01" "010" "011" "012" ...</span>
<span class="co">#&gt;  $ name          : chr  "MAKE PUBLIC STATEMENT" "Make statement" "Decline comment" "Make pessimistic comment" ...</span>
<span class="co">#&gt;  $ level         : num  0 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ lvl0          : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ lvl1          : int  NA 10 11 12 13 14 15 16 17 18 ...</span>
<span class="co">#&gt;  $ description   : chr  NA "All public statements expressed verbally or in action not otherwise specified." "Explicitly decline or refuse to comment on a situation." "Express pessimism, negative outlook." ...</span>
<span class="co">#&gt;  $ usage_notes   : chr  NA "This residual category is not coded except when distinctions among 011 to 017 cannot be made. Note that statements are typicall "This event form is a verbal act. The target could be who the source actor declines to make a comment to or about." "This event form is a verbal act. Only statements with explicit pessimistic components should be coded as 012; otherwise, defaul ...</span>
<span class="co">#&gt;  $ example       : chr  NA "U.S. military chief General Colin Powell said on Wednesday NATO would need to remain strong." "NATO on Monday declined to comment on an estimate that Yugoslav army and special police troops in Kosovo were losing 90 to 100  "Former West Germany Chancellor Willy Brandt said in a radio interview broadcast today he was skeptical over Moscow\u0082\xc4\xf ...</span>
<span class="co">#&gt;  $ order         : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ quad_category : chr  "verbal cooperation" "verbal cooperation" "verbal cooperation" "verbal cooperation" ...</span>
<span class="co">#&gt;  $ penta_category: chr  "statement" "statement" "statement" "statement" ...</span></code></pre></div>
<p>And, a dictionary mapping Goldstein scores to CAMEO codes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"goldstein_mappings"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(goldstein_mappings)
<span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    312 obs. of  5 variables:</span>
<span class="co">#&gt;  $ code     : chr  "01" "010" "011" "012" ...</span>
<span class="co">#&gt;  $ name     : chr  "MAKE PUBLIC STATEMENT" "Make statement" "Decline comment" "Make pessimistic comment" ...</span>
<span class="co">#&gt;  $ goldstein: num  0 0 -0.1 -0.4 0.4 0 0 -5 0 3.4 ...</span>
<span class="co">#&gt;  $ nsLeft   : int  1 2 4 6 8 10 12 14 16 18 ...</span>
<span class="co">#&gt;  $ nsRight  : int  22 3 5 7 9 11 13 15 17 19 ...</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/andybega/icews">https://​github.com/​andybega/​icews</a>
</li>
<li>Report a bug at <br><a href="https://github.com/andybega/icews/issues">https://​github.com/​andybega/​icews/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Andreas Beger <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0003-1883-3169" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=icews"><img src="https://www.r-pkg.org/badges/version/icews" alt="CRAN status"></a></li>
<li><a href="https://travis-ci.org/andybega/icews"><img src="https://travis-ci.org/andybega/icews.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/github/andybega/icews?branch=master"><img src="https://codecov.io/gh/andybega/icews/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Andreas Beger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
