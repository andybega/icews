<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Update database and files — update_icews • icews</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Update database and files — update_icews"><meta property="og:description" content="Maintain a current set of ICEWS events in the local database that match
the latest versions on DVN. If needed, create the database and download data
files."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">icews</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/icews.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/database-internals.html">Database internals</a>
    </li>
    <li>
      <a href="../articles/icews-event-data.html">ICEWS event data</a>
    </li>
    <li>
      <a href="../articles/speed-comparison-database-versus-file-based.html">Speed comparison database versus file-based</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/andybega/icews/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Update database and files</h1>
    <small class="dont-index">Source: <a href="https://github.com/andybega/icews/blob/HEAD/R/update.R" class="external-link"><code>R/update.R</code></a></small>
    <div class="hidden name"><code>update_icews.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Maintain a current set of ICEWS events in the local database that match
the latest versions on DVN. If needed, create the database and download data
files.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">update_icews</span><span class="op">(</span></span>
<span>  dryrun <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_db <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"icews.use_db"</span><span class="op">)</span>,</span>
<span>  keep_files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"icews.keep_files"</span><span class="op">)</span>,</span>
<span>  db_path <span class="op">=</span> <span class="fu"><a href="find_raw.html">find_db</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  raw_file_dir <span class="op">=</span> <span class="fu"><a href="find_raw.html">find_raw</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plan <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dryrun</dt>
<dd><p>Just list changes that would be made, without making them.</p></dd>


<dt>use_db</dt>
<dd><p>Store events in a SQLite database?</p></dd>


<dt>keep_files</dt>
<dd><p>If using a database, retain raw data TSV files?</p></dd>


<dt>db_path</dt>
<dd><p>Path to SQLite database file</p></dd>


<dt>raw_file_dir</dt>
<dd><p>Directory containing the raw event TSV files.</p></dd>


<dt>quiet</dt>
<dd><p>Don't print progress messages</p></dd>


<dt>plan</dt>
<dd><p>Shortcut to avoid talking to dataverse twice, see examples
below.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The behavior of <code>update_icews</code> depends on the ICEWS option values,
as set via <code>setup_icews</code>, or alternatively manually specified function
arguments. The intended use is with options set in .Rprofile.</p>
<p>If "use_db" and "keep_files" are both true, data files will be downloaded to
the "raw" directory in the root ICEWS directory
(<code>get_icews_opts()$data_dir</code>), then ingested into a SQLite database in the
"db" directory. Each data file is ingested before the next one is downloaded,
so that if the process is interrupted there will be at least some data in the
database.</p>
<p>If "use_db" is set with "keep_files" as false, data is downloaded to
temporary files before ingestion. This saves about 5GB of space as of late
2018.</p>
<p>If "use_db" is false, then regardless of the "keep_files" value, only the
raw data files will be downloaded. This is equivalent to <code><a href="download_data.html">download_data()</a></code>.</p>
<p>You can manually replicate what <code>update_icews()</code> does by calling
<code><a href="download_data.html">download_data()</a></code>, followed by <code><a href="sync_db_with_files.html">sync_db_with_files()</a></code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># assuming this is the first time the package is used:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="setup_icews.html">setup_icews</a></span><span class="op">(</span><span class="st">"path/to/icews_data"</span>, use_db <span class="op">=</span> <span class="cn">TRUE</span>, keep_files <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>            r_profile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see the plan for the initial download</span></span></span>
<span class="r-in"><span><span class="co"># update_icews(dryrun = TRUE)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># do the initial download; this will take a while (1hr or so)</span></span></span>
<span class="r-in"><span><span class="co"># update_icews(dryrun = FALSE)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># talking to dataverse takes takes up some time and doing it twice</span></span></span>
<span class="r-in"><span><span class="co"># can be avoided by doing:</span></span></span>
<span class="r-in"><span><span class="co"># plan &lt;- update_icews(dryrun = TRUE)</span></span></span>
<span class="r-in"><span><span class="co"># update_icews(dryrun = FALSE, plan = plan)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># call it again in the future to check if updates are needed</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andreas Beger.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

